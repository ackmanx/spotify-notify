import './artist.less'
import React from 'react'
import {connect} from 'react-redux'

import {Album} from '../album/album'
import {markArtistAsSeen} from '../../redux/actions/seen-albums'
import {bemFactory} from '../../utils/utils'

const bem = bemFactory('artist')

const SVG = () => {
    return (
        <svg xmlns="http://www.w3.org/2000/svg">
            <path d="m5.065,12.171c-0.855,0.597 -0.935,0.931 -0.937,0.95c1.72,2.094 13.314,1.018 15.077,0.785c3.896,-0.519 11.625,-2.008 15.096,-4.432c0.854,-0.596 0.934,-0.93 0.936,-0.95c-1.719,-2.094 -13.315,-1.019 -15.075,-0.785c-3.897,0.519 -11.626,2.009 -15.097,4.432zm8.734,22.384c-0.629,-3.121 -0.024,-5.693 1.352,-5.746c1.375,-0.052 3.002,2.436 3.631,5.557c0.63,3.12 0.024,5.693 -1.351,5.746c-1.377,0.052 -3.002,-2.436 -3.632,-5.557zm-2.812,16.116l0.007,-0.191c0.341,-0.627 1.092,-0.905 3.342,-0.5c5.571,1.248 11.221,1.473 16.016,-0.402c-7.816,0.839 -13.702,0.154 -16.417,-1.338c-1.959,-1.013 -2.88,-2.029 -3.266,-4.404c-1.012,-9.446 -4.044,-21.273 -5.832,-27.822c7.336,2.268 25.262,-0.813 30.767,-4.639c1.947,14.257 3.296,20.842 6.135,34.047c0.206,0.326 0.384,1.487 0.364,1.823c-0.112,1.854 -6.381,5.209 -16.032,6.366c-4.386,0.525 -8.288,0.293 -11.075,-0.388c-3.057,-0.747 -3.993,-1.811 -4.032,-2.32l0.023,-0.232zm-9.521,4.132c0.005,-0.455 1.275,-0.888 2.835,-0.968c0.312,-0.016 0.603,-0.021 0.881,-0.008c0.207,0.011 0.403,0.027 0.586,0.051c1.31,0.103 2.393,0.113 3.25,0.03c-0.785,0.217 -1.39,0.485 -2.074,0.907c-0.4,0.337 -1.441,0.613 -2.66,0.674c-1.56,0.078 -2.822,-0.228 -2.818,-0.686zm44.481,3.759c-0.095,-0.646 -1.321,-1.55 -3.68,-2.75c2.032,0.835 4.641,1.465 7.829,1.89l0.349,0.045l0.187,0.022c0.884,0.164 1.492,0.458 1.492,0.793c0,0.505 -1.384,0.915 -3.089,0.915c-1.706,0 -3.088,-0.411 -3.088,-0.915zm4.498,-0.816l0.165,0.027l-0.165,-0.027zm32.043,-55.9c1.902,-1.018 3.923,1.588 4.069,3.954c0.145,2.341 -0.485,3.369 -1.79,3.955l-43.877,19.725c0.923,5.01 1.93,10.018 3.034,15.139c0.886,2.17 0.333,3.948 -1.026,5.397c-0.113,0.938 -2.545,3.264 -2.376,3.479c0.188,0.348 0.773,0.398 2.255,0.373l0.413,-0.006c0.912,0 1.65,0.234 1.65,0.522c0,0.29 -0.738,0.524 -1.65,0.524c-0.747,0 -1.442,-0.157 -1.856,-0.372c-1.471,-0.519 -3.178,0.362 -3.66,0.543c-1.036,0.434 -0.763,1.384 -0.079,2.157c2.387,2.701 9.453,6.665 11.578,6.95c1.064,0.149 1.845,0.481 1.845,0.867c0,0.514 -1.382,0.931 -3.088,0.931s-3.089,-0.417 -3.089,-0.931c0,-0.088 0.041,-0.174 0.118,-0.254c0.571,-1.671 -11.566,-8.55 -14.12,-8.136c-1.614,0.228 -3.357,0.396 -5.181,0.492c-1.129,0.5 -1.056,2.166 1.52,3.232c0.271,0.119 0.425,0.26 0.425,0.409c0,0.438 -1.315,0.79 -2.938,0.79c-1.622,0 -2.938,-0.353 -2.938,-0.79c0,-0.176 0.218,-0.34 0.584,-0.473c1.605,-1.146 0.881,-2.837 -0.344,-3.061c0,0 -1.52,-0.161 -3.465,-0.448c-3.124,0.061 -4.702,0.726 -4.942,2.303c0.001,0.427 -0.796,0.749 -1.779,0.749c-0.983,0 -1.781,-0.322 -1.781,-0.721c0,-0.25 0.319,-0.472 0.801,-0.6c3.016,-1.022 4.121,-1.929 3.465,-2.492c-2.192,-0.487 -4.006,-1.097 -4.043,-1.789c-0.007,-0.146 0.02,-0.29 0.081,-0.436c-1.163,-0.819 -1.814,-1.918 -1.612,-3.383c0.352,-10.29 -4.722,-29.005 -6.993,-37.142l0.104,-0.017c-0.042,-1.055 0.735,-2.164 1.945,-3.008c5.813,-4.058 25.614,-7.284 31.974,-4.188c0.797,0.389 1.311,0.854 1.589,1.355l0.134,0.291c0.105,0.284 0.141,0.576 0.117,0.87c0.478,3.533 0.987,6.993 1.534,10.415l43.392,-17.175z"
                  clipRule="evenodd" fillRule="evenodd" fill="white"/>
        </svg>
    )
}

const _Artist = props => {
    const {artist, markArtistAsSeen} = props

    const albums = artist.albums.filter(album => album.type === 'album')
    const singles = artist.albums.filter(album => album.type === 'single')

    const hasAlbums = !!albums.length
    const hasSingles = !!singles.length

    if (!hasAlbums && !hasSingles) {
        return null
    }

    return (
        <div className={bem()}>
            <h2 className={bem('name')} onClick={() => markArtistAsSeen(artist.id)} style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between'}}>
                <div>
                    {artist.name}
                </div>
                <div style={{width: '90px', height: '60px'}}>
                    <SVG />
                </div>
            </h2>

            {hasAlbums && <>
                <h3 className={bem('album-group')}>Albums</h3>
                {albums.map(album => <Album key={album.id} album={album}/>)}
            </>}

            {hasSingles && <>
                <h3 className={bem('album-group')}>Singles</h3>
                {singles.map(single => <Album key={single.id} album={single}/>)}
            </>}
        </div>
    )
}

const mapStateToProps = state => ({})

const mapDispatchToProps = dispatch => ({
    markArtistAsSeen: artistId => dispatch(markArtistAsSeen(artistId))
})

export const Artist = connect(mapStateToProps, mapDispatchToProps)(_Artist)
